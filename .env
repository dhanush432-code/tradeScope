# Server
PORT=3001
SESSION_SECRET=a_very_strong_and_long_random_secret_key

# PostgreSQL
DATABASE_URL="postgresql://postgres:Jaya%401974@localhost:5432/trade_pad"

# Google OAuth
GOOGLE_CLIENT_ID=717137012301-81t086m31sic50kqr11rck9od8td07hb.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=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
CALLBACK_URL=/auth/google/callback

# Upstox API
UPSTOX_CLIENT_ID=bec7c5b8-5ae5-404d-93e1-356452edc699
UPSTOX_CLIENT_SECRET=djv30y03b4
UPSTOX_REDIRECT_URI=https://trade-backend-gzw3.onrender.com/api/upstox/callback

FRONTEND_URL=https://meek-tanuki-2563af.netlify.app


**Key Change:** `UPSTOX_REDIRECT_URI=https://trade-backend-gzw3.onrender.com/api/upstox/callback`

## Important: Update Upstox Developer Console

You also need to update the redirect URI in your **Upstox Developer Console**:

1. Go to [Upstox Developer Console](https://account.upstox.com/developer/apps)
2. Find your app with client ID `bec7c5b8-5ae5-404d-93e1-356452edc699`
3. Update the **Redirect URI** to: `https://trade-backend-gzw3.onrender.com/api/upstox/callback`
4. Save the changes

## How the OAuth Flow Works

Here's the correct flow:
```
1. User clicks "Connect with Upstox" in your frontend
   ↓
2. Frontend calls: GET /api/upstox/auth-url
   ↓
3. Backend returns: https://api.upstox.com/v2/login/authorization/dialog?client_id=...&redirect_uri=https://trade-backend-gzw3.onrender.com/api/upstox/callback
   ↓
4. Frontend redirects user to Upstox login page
   ↓
5. User logs in and authorizes on Upstox
   ↓
6. Upstox redirects to: https://trade-backend-gzw3.onrender.com/api/upstox/callback?code=xxx
   ↓
7. Backend exchanges code for access token
   ↓
8. Backend saves token to database
   ↓
9. Backend redirects to: https://meek-tanuki-2563af.netlify.app/brokers?upstox_success=true
   ↓
10. Frontend shows success message